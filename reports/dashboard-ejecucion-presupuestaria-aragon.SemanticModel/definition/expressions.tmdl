expression fn_Transformar_Gastos =
		let
		    Origen = (miArchivo as binary) =>
		let
		    // Leer CSV sin forzar columnas ni encoding
		    Origen = Csv.Document(
		        miArchivo,
		        [
		            Delimiter = ",",
		            QuoteStyle = QuoteStyle.None
		        ]
		    ),
		
		    // Promover encabezados
		    Encabezados = Table.PromoteHeaders(
		        Origen,
		        [PromoteAllScalars = true]
		    ),
		
		    // Limpiar descripción (si existe)
		    TextoLimpio =
		        if Table.HasColumns(Encabezados, "Descripcion") then
		            Table.TransformColumns(
		                Encabezados,
		                {
		                    {"Descripcion", each Text.Trim(Text.Clean(_)), type text}
		                }
		            )
		        else
		            Encabezados,
		
		    // Convertir columnas numéricas con cultura US
		    TipoNumerico =
		        Table.TransformColumnTypes(
		            TextoLimpio,
		            {
		                {"Credito inicial", type number},
		                {"Modificaciones", type number},
		                {"Credito Definitivo", type number},
		                {"Comprometido", type number},
		                {"Obligaciones Reconocidas", type number},
		                {"Pagado", type number}
		            },
		            "en-US"
		        )
		in
		    TipoNumerico,
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "en-US"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: a9b2835f-b0c8-4fcd-8e59-00fbb22d7c35

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Exception

expression 'Estado de ejecución gastos - 2024' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2024.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 9892bb82-cf24-480e-8f35-adb28f2ef574

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2015' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2015.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 4185e892-70b9-4447-aea4-466c868d38e1

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2014' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2014.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 916f90c5-7813-4534-9468-894941925ed1

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2016' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2016.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 746f2053-114d-43ce-ba87-7d33842d0f9b

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2017' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2017.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: b7a017c1-6c24-4e08-8c9c-c32597769393

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2018' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2018.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: bdb7e7b3-b144-4561-b117-46f273c96e2f

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2019' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2019.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 1fbaeb0e-6b92-4370-a7c3-f7c44253c27e

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2020' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2020.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 76c0319a-165b-45a6-b310-24abb313f398

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2021' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2021.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 4b404919-aebb-4c66-8c72-bfea16ea2f93

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2022' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2022.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 5152dae5-a47f-4a3a-bfd6-c331893a159e

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2023' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2023.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "es-ES"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: c90b0cf1-0577-436e-984d-14735355dc2c

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

expression 'Estado de ejecución gastos - 2013' =
		let
		    Origen = Csv.Document(File.Contents("C:\Users\Juan Manuel\Documents\PERSONALES\PROYECTOS\Power BI - dashboard-ejecucion-presupuestaria\data\raw\Estado de ejecución gastos\Estado de ejecución gastos - 2013.csv"),[Delimiter=",", Columns=13, Encoding=65001, QuoteStyle=QuoteStyle.None]),
		    #"Cambiar tipo" = Table.TransformColumnTypes(Origen,{{"Column1", type text}, {"Column2", type text}, {"Column3", type text}, {"Column4", type text}, {"Column5", type text}, {"Column6", type text}, {"Column7", type text}, {"Column8", type text}, {"Column9", type text}, {"Column10", type text}, {"Column11", type text}, {"Column12", type text}, {"Column13", type text}}),
		    #"Encabezados promovidos" = Table.PromoteHeaders(#"Cambiar tipo", [PromoteAllScalars=true]),
		    #"Tipo cambiado con configuración regional" = Table.TransformColumnTypes(#"Encabezados promovidos", {{"Credito inicial", type number}, {"Modificaciones", type number}, {"Credito Definitivo", type number}, {"Comprometido", type number}, {"Obligaciones Reconocidas", type number}, {"Pagado", type number}}, "en-US"),
		    #"Texto recortado" = Table.TransformColumns(#"Tipo cambiado con configuración regional",{{"Descripcion", Text.Trim, type text}}),
		    #"Texto limpio" = Table.TransformColumns(#"Texto recortado",{{"Descripcion", Text.Clean, type text}})
		in
		    #"Texto limpio"
	lineageTag: 99bad68f-2a0e-4d06-b18d-b7535b0c9586

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

